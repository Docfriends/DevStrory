---
layout: post
title: "암호화와 복호화"
description: "암호, 암호화, 복호화, 암호화의 종류, 공개키, 비공개키"
date: 2021-09-11
tags: [iOS]
writer: zehye
category: iOS
comments: true
share: true
---

안녕하세요. 닥프렌즈 iOS 개발자 박지혜입니다.

<br/>


## 암호란?

평문을 암호문으로 변환하거나 암호문을 평문으로 변환하는 기술을 의미합니다.

- 평문: 해독 가능한 형태의 텍스트. 예: "123456"
- 암호문: 해독 불가능한 형태의 텍스트. 예: "aWfwlknr!"



### 암호화와 복호화

- 암호화: 평문을 암호문으로 변환하는 과정
  - 예: 평문("123456") -> 암호화 -> 암호문("aEerwlrkn!")
- 복호화: 암호문을 평문으로 변환하는 과정
  - 예: 암호문("aQwqlen!") -> 복호화 -> 평문("123456")


### 암호화의 종류

- 단방향 암호화: 암호화 후 복호화를 할 수 없다.
  - 예: 사용자 비밀번호: 사용자가 입력한 비밀번호를 암호화하여 DB에 저장이 될 때, 모든 접근자(개발자 포함)은 암호화 된 코드를 다시 평문으로 볼 수 없다. 또한 해킹이 되어도 복호화가 매우 힘든것이 특징입니다.
  - 해시 방식이 대표적

- 양방향 암호화: 암호화와 복호화 모두 가능하다.
  - 예: 사용자 주고, 이메일, 번호 또는 전자 서명 같이 재사용성이 있는 정보는 암호화, 복호화 모두 이루어져야 합니다.
  - 대칭키, 비대칭키 방식이 대표적

이때, 양방향 암호화에는 두 가지 종류가 존재합니다.

1. 대칭형(비밀키 암호): 암호화, 복호화 시 모두 동일한 키를 사용 > 주로 데이터 통신 암호화에 많이 쓰인다.
2. 비대칭형(공개키 암호): 암호화, 복호화에 서로 다른 키를 사용 > 주로 인증에 많이 쓰인다.


## 암호 알고리즘

평문을 암호문으로 어떻게 만드는 지에 대해 알아봅시다.<br>
사용자가 정보를 입력하여 DB로 전달되지 전에, 입력값을 암호문으로 변경해주는 알고리즘이 있습니다.


### 단방향 알고리즘

단방향 알고리즘은 다양하지만, 그 중 가장 많이 쓰이는 해시함수 알고리즘이 적용된 것들을 소개해 드리겠습니다.

1. SHA

SHA를 보안해 좀 더 쉽게 사용가능한 알고리즘

1. PBKDF2
2. bcrypt
3. scrypt

평문을 암호문으로 암호화하는 것은 가능하지만 암호문을 평문으로 복호화하는것은 불가능한 암호화 기법으로 기본적으로 동일한 평문은 동일한 암호문으로 암호화 되지만 이를 바탕으로 평문을 복호화 할 수 없는것이 특징입니다. 예로 들어 패스워드는 양방형 암호로 저장하는것보다 단반향 암호로 저장하는 것이 안전한데, 그 이유는 암호화된 패스워드 목록이 털린다고 해도 이를 가지고 원래의 패스워드를 복원할 수 없고, 패스워드 자체를 검증할 때는 입력 받은 값을 암호화해서 암호화한 값 끼리 비교하여 인증처리를 하기 때문입니다.

주로 해시 기법을 사용합니다.

### 양방향 알고리즘

1. 대칭형(비공개키 암호) 알고리즘

암호화, 복호화에 서로 동일한 키가 사용되는 암호화 방식으로 키를 비공개하는것이 특징입니다. 속도가 빠르다는 장점이 존재하지만 키 배송 위험성이 존재하여 송신 측에서 수신측에 암호키를 전달하는 과정에서 노출 우려가 있는 단점이 존재합니다. 대표적으로는 DES, AES가 있습니다.


대칭키(비공개키)는 사용하는 키와 복호화 할때 사용하는 키가 동일한 암호화 기법으로, 대게 암호화 알고리즘이라 하면 위 알고리즘을 가리킵니다. 현재 가장 보편적으로 쓰이는 암호화 방식은 현 미국 표준 방식인 AES로 128~256비트 키를 적용할 수 있어 보안성이 뛰어나며 공개된 알고리즘이라 누구나 사용가능합니다. 그 전에는 DES(Data Encrytion Standard)라는 알고리즘이 1975년부터 사용되고 있었으나 너무 오래되어 취약점이 발견됨에 따라 이를 대체 하기 위해 등장한 것이 AES라고 합니다.

대칭형 암호는 훌륭한 암호화 방식이긴 하지만 **키 배송** 관련으로 결정적인 문제가 존재합니다. 어떻게든 송신 측에는 수신 측에 암호키를 전달해야만 하고, 이 키가 배송과정에서 틸리게 되면 아무리 뛰어ㅏㄴ 암호화 알고리즘을 사용했더라도 속절없이 평문이 털리게 됩니다. 안전하게 평문을 전달하기 위해 만든 것이 암호문인데, 정작 키는 안전하게 전달할 방법이 없다는 것이 가장 큰 단점입니다. 따라서 이 키 배송에 대한 방법이 여러가지 연구되었지만 결국 발상의 전환으로 키 배송 문제를 해결하기 위해 나타난 방식이 바로 비대칭형 암호 입니다.


AES: 고급 암호화 표준

1. 정보를 입력하는
2. 우리가 사용할 키 > 절대로 노출되면 안됨
3. 어떤 수준으로 암호화 할 것인가. 비트수가 높을 수록 그 암호화는 안전 > 그치만 컴퓨팅 파워를 더 많이사용

> 버튼 누르면 아래 정보가 뜨는데, 이 정보를 통해 원래 정보를 알아낼 수 없지만 저 안에는 신기하게도 비밀 비밀 이라는 정보가 들어가 있다.
이를 풀기 위해서는 많은 컴퓨팅 파워와 시간이 들기 때문에 그만큼 안전하다고 하는것

이 만들어진 정보를 복사해서 다시 리로드 하고 얻은 복사한 정보를 복붙, 키값을 입력하고 비트 수 맞춰서 복호화 누름
원래의 결과 나타남




2. 비대칭형(공개키 암호) 알고리즘

암호화, 복호화에 서로 다른 키가 사용되는 방식으로 하나의 키는 공개키로 사용하는 것이 특징입니다. 키 배송의 문제를 근본적으로 차단하여 안정성이 높지만 대칭키 방식에 비해 속도가 느리다는 단점이 존재합니다. 대표적으로는 RSA가 있습니다.

- RSA: 공개키 암호 시스템의 하나로 암호화뿐만 아니라 전자서명이 가능한 최초의 알고리즘

비 대칭형 암호는 이름 그대로 암호화 키와 복호화 키가 다른 것 입니다. 암호화를 하면 하나의 키 쌍이 생기고 이 두개의 키는 수학적으로 밀접한 관계를 가지게 됩니다. 두개의 키를 각각 A키, B키 라고 했을 때 A키로 암호화 한 암호는은 B키로만 복호화 할 수 있고, B키로 암호화 한 암호문은 A키로만 복호화 할 수 있습니다. 따라서 이 중 하나의 키만 비밀로 하고(이를 비밀키, 개인키라고 합니다) 다른 하나의 키는 누구에게 공개해도(이를 공개키라고 합니다) 관계가 없는것이 특징입니다.

이렇게 둘 중 하나의 키는 반드시 공개되어야 통상적인 사용이 가능함으로 공개키 암호라고도 불립니다. 공개ㅣ로 암호화한 암호문은 어짜피 개인키를 가진 사람만이 풀어볼 수 있기 때문에 상호간에 공개키만 교환하고 상대의 공개키로 암호화를 해서 데이터를 교환하면 상대는 자신의 개인키로 복호화를 하게 됩니다. 따라서 키 배송 문제는 근본적으로 발생하지 않게 됩니다.

하지만 비대칭형 암호는 암호화, 복호화가 대칭형 암호에 비해 현저하게 느리다는 문제점이 존재합니다. 따라서 현실적으로는 비대칭형 암호를 이용해 대칭형 암호의 키를 배송하고 실제 암호문은 대칭형 암호를 사용하는 식으로 상호 보완적으로 이용하는 것이 일반적입니다. 그리고 비대칭형 암호라고 약점이 없는것은 아닙니다.

> 중간자 공격: 해커가 중간에서 통신을 가로채어 수신자에게는 송신자인 척 하고 송신자에게는 수신자인 척 해서 양쪽의 공개키와 실제 암호화에 사용되는 대칭키를 모두 얻어내는 기법



예:
공개키: 사람들에게 공개된 키로 정보를 암호화만 할 수 있는 키
비밀키: 사용자만 알고 있는암호를 풀수 있는 키

인터넷 뱅킹
사용자가 인터넷 은행 사이트에 접속하면 사용자 컴퓨터에는 공개키와 비밀키가 생성된다.
사용자 컴퓨터에서 공개키가 은행 사이트로 전송되면 은행 사이트에서는 중요한 정보를 공개키로 암호화하여 암호문을 사용자에게 전달
사용자는 비밀키로 암호문을 해독해 중요한 정보를 은행과 공유 하며 통신을 하게 된다.

공인인증서, 전자서명은 이러한 공개키 방식을 사용하고 있음
